<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>Supabase Test</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>
    <h1>Supabase Connectie Test</h1>
    <div id="results"></div>

    <script type="module">
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
        
        const SUPABASE_URL = 'https://ltwolxjbmdopjslnlkx.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_-hFbgnkMK4xn3uAaqJEuxA_C_9HAV6e';
        const client = createClient(SUPABASE_URL, SUPABASE_KEY);
        
        const results = document.getElementById('results');
        
        async function testSupabase() {
            results.innerHTML = '<p>Testing Supabase connection...</p>';
            
            try {
                // Test 1: Basic connection
                results.innerHTML += '<p>‚úÖ Supabase client created</p>';
                
                // Test 2: Check if users table exists
                const { data: users, error: usersError } = await client
                    .from('users')
                    .select('count')
                    .limit(1);
                
                if (usersError) {
                    results.innerHTML += `<p>‚ùå Users table error: ${usersError.message}</p>`;
                } else {
                    results.innerHTML += '<p>‚úÖ Users table accessible</p>';
                }
                
                // Test 3: Check if duiven table exists
                const { data: duiven, error: duivenError } = await client
                    .from('duiven')
                    .select('count')
                    .limit(1);
                
                if (duivenError) {
                    results.innerHTML += `<p>‚ùå Duiven table error: ${duivenError.message}</p>`;
                } else {
                    results.innerHTML += '<p>‚úÖ Duiven table accessible</p>';
                }
                
                // Test 4: Try to insert a test user
                const testEmail = 'test@example.com';
                const { data: insertData, error: insertError } = await client
                    .from('users')
                    .insert({
                        email: testEmail,
                        naam: 'Test User',
                        team_naam: 'Test Team',
                        locatie: 'Test Location',
                        wachtwoord: 'Test123'
                    })
                    .select();
                
                if (insertError) {
                    results.innerHTML += `<p>‚ùå Insert error: ${insertError.message}</p>`;
                    
                    // Check if it's RLS error
                    if (insertError.message.includes('new row violates row-level security policy')) {
                        results.innerHTML += '<p>üîí RLS Policy blocking insert</p>';
                    }
                } else {
                    results.innerHTML += '<p>‚úÖ Insert successful</p>';
                    
                    // Clean up test user
                    await client.from('users').delete().eq('email', testEmail);
                }
                
            } catch (error) {
                results.innerHTML += `<p>‚ùå General error: ${error.message}</p>`;
            }
        }
        
        testSupabase();
    </script>
</body>
</html> 